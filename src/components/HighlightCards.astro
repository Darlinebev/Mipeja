---
interface Props {
  bookingUrl?: string;
}

const { bookingUrl = "#" } = Astro.props;

const highlights = [
  {
    id: "accommodation",
    title: "Accommodation",
    description:
      "Relax in style—our rooms blend comfort, elegance, and modern amenities for the perfect stay.",
    detailedDescription: "Experience luxury redefined in our thoughtfully designed rooms featuring premium bedding, modern amenities, and stunning views. Each room is crafted to provide the perfect balance of comfort and sophistication for your stay.",
    image:
      "https://images.unsplash.com/photo-1631049307264-da0ec9d70304?w=600&h=400&fit=crop",
    link: "/rooms",
  },
  {
    id: "dining",
    title: "Dining",
    description:
      "Savor every moment—experience gourmet flavors and local specialties at our signature restaurant.",
    detailedDescription: "Indulge in our award-winning restaurant offering a diverse menu of international and local Kenyan cuisine. Our expert chefs use only the finest ingredients to create memorable culinary experiences in an elegant setting.",
    image:
      "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?w=600&h=400&fit=crop",
    link: "#dining",
  },
  {
    id: "conference",
    title: "Conference Facilities",
    description:
      "Connect and create—state-of-the-art spaces designed for impactful meetings, events, and celebrations.",
    detailedDescription: "Host successful meetings, conferences, and special events in our modern facilities equipped with state-of-the-art technology, comfortable seating, and professional service. Perfect for business gatherings and celebrations.",
    image:
      "https://images.unsplash.com/photo-1552664730-d307ca884978?w=600&h=400&fit=crop",
    link: "#amenities",
  },
];
---

<section class="py-24 md:py-32 bg-white overflow-hidden">
  <div class="max-w-7xl mx-auto px-6">
    <!-- Section Title -->
    <div class="text-center mb-16">
      <p class="text-[12px] uppercase tracking-[0.4em] text-deep-teal font-bold mb-6 animate-fade-in-down">Experience</p>
      <h2 class="text-4xl md:text-5xl lg:text-6xl font-display text-charcoal-gray leading-tight animate-fade-in-up">
        Hotel Highlights
      </h2>
    </div>

    <!-- Grid of Highlight Cards -->
    <div class="grid md:grid-cols-3 gap-8 lg:gap-10">
      {
        highlights.map((card, index) => (
          <div
            class="facility-card group relative overflow-hidden rounded-2xl h-96 cursor-pointer"
            style={`animation-delay: ${index * 0.15}s`}
          >
            <!-- Background Image -->
            <div class="absolute inset-0">
              <img
                src={card.image}
                alt={card.title}
                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                loading="lazy"
              />
              <!-- Overlay -->
              <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
            </div>

            <!-- Collapsed View (Always visible initially) -->
            <div class="absolute inset-0 flex flex-col justify-end p-6 transition-all duration-300 group-hover:opacity-0 group-hover:invisible z-10">
              <h3 class="text-2xl font-bold text-white font-display mb-3">
                {card.title}
              </h3>
              <p class="text-sm text-gray-200 leading-relaxed line-clamp-3">
                {card.description}
              </p>
            </div>

            <!-- Expanded View (Appears on hover/click) -->
            <div class="absolute inset-0 flex flex-col justify-between p-8 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 z-20 bg-gradient-to-br from-black/80 via-black/85 to-black/90">
              <!-- Content Section -->
              <div class="space-y-6 flex flex-col justify-center h-full">
                <h3 class="text-3xl font-bold text-white font-display">
                  {card.title}
                </h3>
                <p class="text-gray-300 text-base leading-relaxed">
                  {card.detailedDescription}
                </p>
              </div>

              <!-- Bottom Section: Action Button -->
              <a href={card.link} class="w-full bg-deep-teal hover:bg-deep-teal/90 text-white font-bold py-3 rounded-lg transition-colors duration-200 text-sm uppercase tracking-widest text-center block">
                Explore More →
              </a>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>

<style>
  @media (max-width: 1024px) {
    .facility-card {
      /* Mobile: Expand on tap/click */
    }

    .facility-card.expanded {
      min-height: 500px;
    }

    .facility-card.expanded > div:first-of-type::after {
      opacity: 0;
    }
  }

  /* Smooth transition for mobile toggle */
  .facility-card {
    transition: all 0.3s ease;
  }

  /* Ensure reveal animation triggers */
  .facility-card {
    opacity: 0;
    transform: translateY(30px);
    animation: fadeInUp 0.8s cubic-bezier(0.5, 0, 0, 1) forwards;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>

<script>
  // Mobile toggle functionality
  function initializeHighlightCards() {
    const cards = document.querySelectorAll('.facility-card');

    cards.forEach(card => {
      // Skip hover-based expansion on touch devices
      if (!('ontouchstart' in window)) {
        return;
      }

      card.addEventListener('click', (e) => {
        // Close other expanded cards
        cards.forEach(c => {
          if (c !== card) {
            c.classList.remove('expanded');
          }
        });

        // Toggle current card
        card.classList.toggle('expanded');
        e.stopPropagation();
      });
    });

    // Close expanded card when clicking outside
    document.addEventListener('click', () => {
      cards.forEach(card => {
        card.classList.remove('expanded');
      });
    });
  }

  // Initialize on DOMContentLoaded and after Astro transitions
  document.addEventListener('DOMContentLoaded', initializeHighlightCards);
  document.addEventListener('astro:after-swap', initializeHighlightCards);
</script>
